openapi: 3.0.0
info:
  title: videos
  version: 1.2.0
  description: StreamHub Video API - EARLY DEV
  contact:
    name: Elias Huber
    url: 'http://www.huber.host'
    email: elias@huber.host
  termsOfService: 'http://streamhub.huber.host/tos'
  license:
    name: Apache 2.0
    url: 'https://www.apache.org/licenses/LICENSE-2.0'
servers:
  - url: 'http://videos-v1-api-edev-streamhub.0.0.0.0.xip.io:8084'
    description: videos-v1-edev
paths:
  '/video/{hash}':
    parameters:
      - $ref: '#/components/parameters/Hash'
    get:
      summary: Video GET endpoint
      tags:
        - video
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                properties:
                  video:
                    $ref: '#/components/schemas/Video'
                  location:
                    $ref: '#/components/schemas/Location'
                required:
                  - video
                  - location
                readOnly: true
              examples: {}
      operationId: getVideoByHash
      description: Get a video by hash
  '/location/{hash}':
    parameters:
      - $ref: '#/components/parameters/Hash'
    get:
      summary: location GET endpoint
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                additionalProperties: false
                properties:
                  location:
                    $ref: '#/components/schemas/Location'
                required:
                  - location
                readOnly: true
              examples: {}
      operationId: getLocationByHash
      description: Get a location by hash
      tags:
        - location
components:
  schemas:
    Video:
      type: object
      title: Video
      description: Video Model
      x-examples: {}
      additionalProperties: false
      x-tags:
        - video
      properties:
        hash:
          $ref: '#/components/schemas/Hash'
        title:
          type: string
          maxLength: 70
        description:
          type: string
          maxLength: 5000
        uploadDate:
          type: string
          format: date-time
          readOnly: true
        locations:
          type: array
          items:
            $ref: '#/components/schemas/Hash'
        type:
          type: array
          items:
            enum:
              - dash
              - hls
            type: string
      required:
        - title
        - description
        - uploadDate
        - type
        - locations
    Location:
      type: object
      title: Location
      description: Location of a video file
      additionalProperties: false
      x-tags:
        - location
      x-examples: {}
      properties:
        hash:
          $ref: '#/components/schemas/Hash'
        server:
          type: string
          minLength: 0
          maxLength: 40
          example: prod.s3.example.com
        bucket:
          type: string
          minLength: 0
          maxLength: 300
          example: sthvideos
        environment:
          type: string
          enum:
            - prod
            - dev
            - test
          maxLength: 10
          minLength: 1
      required:
        - server
        - bucket
        - environment
    Hash:
      type: string
      title: Hash
      minLength: 8
      maxLength: 16
      pattern: '^[A-Za-z0-9]+$'
      description: A 8 to 16 characters long hash
      example: Ej487FoEqy
      x-tags:
        - types
  securitySchemes: {}
  responses: {}
  parameters:
    Hash:
      name: hash
      in: path
      required: true
      schema:
        type: string
        pattern: '^[A-Za-z0-9]+$'
        minLength: 8
        maxLength: 16
      description: A 8 to 16 characters long hash
  examples: {}
tags:
  - name: location
  - name: video
